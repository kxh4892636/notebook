---
id: 87ab83d5-d53f-4ec1-8ce8-be3cefbb2e72
---

# 表单脚本

## 表单

### 表单基础

**HTMLFormElement 类型**

- acceptCharset: 字符集;
- action: url;
- elements: 表单 HTMLCollection;
- enctype: 编码类型;
- length: 控件数量;
- method: HTTP 请求;
- name: 表单名称;
- reset(): 重置表单;
- submit(): 提交;

**获取表单**

```typescript
let form = document.getElementById("form1");
// 取得页面中的第一个表单
let firstForm = document.forms[0];
// 取得名字为"form2"的表单
let myForm = document.forms["form2"];
```

### 表单字段

**访问表单字段**

```typescript
let form = document.getElementById("form1");
// 取得表单中的第一个字段
let field1 = form.elements[0];
// 取得表单中名为"textbox1"的字段
// 若存在多个同名字段, 返回 HTMLCollection
let field2 = form.elements["textbox1"];
// 取得字段的数量
let fieldCount = form.elements.length;
```

**公共属性**

- disabled: 布尔值, 表单字段是否禁用;
- form: 指向表单字段所属的表单;
- name: 字段名称;
- readOnly: 布尔值, 字段是否只读;
- type: 字段类型;
- value: 提交给服务器的值;
- autofocus: 布尔值, 自动获得焦点;

**公共方法**

- focus(): 获得焦点;
- blur(): 取消焦点;

**公共事件**

- blur: 失去焦点时触发;
- change: value 变化时触发;
- focus: 获得焦点时触发;

### 提交表单

**语法格式**

```typescript
// 通用提交按钮
<input type="submit" value="Submit Form" />
// 自定义提交按钮
<button type="submit">Submit Form</button>
// 图片按钮
<input type="image" src="graphic.gif" />

// 提交表单
// 该方式不会触发 submit 事件
let form = document.getElementById("myForm");
form.submit();
```

**submit 事件**

```typescript
// 表单提交前触发 submit 事件
let form = document.getElementById("myForm");
form.addEventListener("submit", (event) => {
  // 阻止表单提交
  event.preventDefault();
});
```

### 重置表单

**语法格式**

```typescript
// 通用重置按钮
<input type="reset" value="Reset Form">
// 自定义重置按钮
<button type="reset">Reset Form</button>

// 重置表单
// 依旧触发 reset 事件
let form = document.getElementById("myForm");
form.reset();
```

**reset 事件**

```typescript
// 表单重置前触发 reset 事件
let form = document.getElementById("myForm");
form.addEventListener("reset", (event) => {
  event.preventDefault();
});
```

## 文本框编程

### 文本框编程基础

**单行文本框**

```typescript
// 一次最多显示 25 个字符, 最大长度为 50 个字符
<input type="text" size="25" maxlength="50" value="initial value">
```

**多行文本框**

```typescript
// 一行最多 25 个字符, 一次最多显示 5 行
<textarea rows="25" cols="5">
  initial value
</textarea>
```

### 选择文本

**select()**

```typescript
// 自动选中文本框所有文字
let textbox = document.forms[0].elements["textbox1"];
textbox.select();
```

**select 事件**

```typescript
// 选中文本后触发
let textbox = document.forms[0].elements["textbox1"];
textbox.addEventListener("select", (event) => {
  console.log(`Text selected: ${textbox.value}`);
});
```

**取得选中文本**

```typescript
// selectionStart 属性为文本起始偏移量
// selectionEnd 属性为文本终止偏移量
function getSelectedText(textbox) {
  return textbox.value.slice(textbox.selectionStart, textbox.selectionEnd);
}

// HTML5 的 setSelectionRange()
textbox.value = "Hello world!";
// 选择所有文本
textbox.setSelectionRange(0, textbox.value.length); // "Hello world!"
// 选择前 3 个字符
textbox.setSelectionRange(0, 3); // "Hel"
// 选择第 4~6 个字符
textbox.setSelectionRange(4, 7); // "o w"
```

### 输入过滤

**屏蔽字符**

```typescript
// 屏蔽数字
textbox.addEventListener("keypress", (event) => {
  // 不屏蔽一些控制按键
  // 若匹配则阻止这次事件
  if (!/\d/.test(String.fromCharCode(event.charCode)) && event.charCode > 9 && !event.ctrlKey) {
    event.preventDefault();
  }
});
```

**剪切板事件**

- beforecopy: 复制前触发;
- copy: 复制时触发;
- beforecut: 剪切前触发;
- cut: 剪切时触发;
- beforepaste: 粘贴前触发;
- paste: 粘贴时重复啊;

**操作剪切板**

```typescript
// 通过 window 对象（IE）或 event 对象（Firefox、Safari 和 Chrome）上的 clipboardData 对象获取剪切板
const clipboardData = event.clipboardData || window.clipboardData;
// 使用 MIME 类型
// 获得剪切板内容
const data = clipboardData.getData("text/plain");
// 设置剪切板内容
const data = clipboardData.setData("text/plain");
// 清理剪切板内容
const data = clipboardData.clearData("text/plain");
```

### HTML5 约束验证 API

**必填字段**

```typescript
// 设置 require 属性
let isUsernameRequired = document.forms[0].elements["username"].required;
```

**设置类型**

```typescript
let input = document.createElement("input");
input.type = "email";
```

**数值范围**

```typescript
input.stepUp(); // 加 1 步长
input.stepUp(5); // 加 5 步长
input.stepDown(); // 减 1 步长
input.stepDown(10); // 减 10 步长
```

**输入模式**

```typescript
// 获取 pattern 属性
let pattern = document.forms[0].elements["count"].pattern;
// 设置 pattern 属性
document.forms[0].elements["count"].pattern = !/\d/;
```

**检测有效性**

```typescript
// 检测单个字段是否有效
if (document.forms[0].elements[0].checkValidity()) {
  // 字段有效，继续
} else {
  // 字段无效
}
// 检测表单 (所有字段) 是否有效
if (document.forms[0].checkValidity()) {
  // 表单有效，继续
} else {
  // 表单无效
}

// validity 属性表示字段为什么有效/无效
const why = input.validity;
```

**禁用验证**

```typescript
const noValidate = document.forms[0].noValidate; // 默认为 false
document.forms[0].noValidate = true; // 关闭验证
```

## 选择框编程

### 基础
